drop table if exists vguo.arpu_by_cid;
create table vguo.arpu_by_cid as
select c.customers,
     sum(a.value_revised) revenue,
from analysts_shared.cubes_rev_dim a 
     right outer join
     (select distinct(customers_id) customers from vguo.monthly_login)c
     on c.customers=a.customers_id
group by c.customers;

-----------------
drop table if exists vguo.arpu_by_cid_1;
create table vguo.arpu_by_cid_1 as
select 
     case when a.revenue is not null then a.revenue else 0.000000 end revenue,
     customers
from vguo.arpu_by_cid a;


--------------------
select stddev_pop(revenue)
from vguo.arpu_by_cid_1;
